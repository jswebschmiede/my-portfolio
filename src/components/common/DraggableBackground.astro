---
interface Props {
  imageUrl: string;
  height?: string;
  alt: string;
  imageHeight: number;
  imageWidth: number;
}

const { imageUrl, height = "600px", alt, imageHeight, imageWidth } = Astro.props;
---

<div
  class="draggable-background-container overflow-hidden relative cursor-grab active:cursor-grabbing w-full touch-none h-[300px] sm:h-[400px] lg:h-[var(--draggable-background-height)]"
  style={`--draggable-background-height: ${height};`}
  role="img"
  aria-label={alt}
  data-draggable
  aria-scrollable="false"
>
  <!-- Scroll Indikator -->
  <div
    class="scroll-indicator absolute bottom-4 left-1/2 -translate-x-1/2 z-10 hidden flex-col items-center gap-1"
    data-scroll-indicator
    aria-hidden="true"
  >
    <div class="relative">
      <svg
        class="absolute -inset-2 w-[calc(100%+1rem)] h-[calc(100%+1.15rem)]"
        viewBox="0 0 120 50"
      >
        <path
          d="M30,40 C10,40 10,10 30,10 C50,10 70,10 90,10 C110,10 110,40 90,40 C70,40 50,40 30,40"
          fill="none"
          stroke="#f97316"
          stroke-width="2.5"
          stroke-linecap="round"
          class="path-animation"
          pathLength="100"></path>
      </svg>
      <span class="text-[length:0.6rem] font-medium text-orange-500 px-3 py-1 rounded-full">
        Scroll mich
      </span>
    </div>
    <svg class="w-5 h-5 text-orange-500" viewBox="0 0 24 24" fill="currentColor">
      <path
        d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"
        transform="rotate(90 12 12)"></path>
    </svg>
  </div>

  <div
    class="draggable-background absolute w-full bg-[length:100%_auto] bg-center transition-transform duration-100 ease-in-out"
    style={`background-image: url(${imageUrl});`}
    data-image-height={imageHeight}
    data-image-width={imageWidth}
    data-draggable-element
  >
  </div>
</div>

<style>
  :root {
    --draggable-background-height: 600px;
  }

  @keyframes pulse {
    0%,
    100% {
      transform: translateY(0) translateX(-50%);
    }
    50% {
      transform: translateY(5px) translateX(-50%);
    }
  }

  .scroll-indicator {
    animation: pulse 2s ease-in-out infinite;
    display: flex !important;
  }

  .path-animation {
    stroke-dasharray: 100;
    stroke-dashoffset: 100;
    animation: draw 1.5s ease-in-out forwards;
  }

  @keyframes draw {
    to {
      stroke-dashoffset: 0;
    }
  }
</style>
